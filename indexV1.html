<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pickleball Tournament V11.4.0</title>
    <link id="favicon" rel="icon" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #e6f3ff;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        h1 {
            text-align: center;
            color: #007bff;
            margin-bottom: 10px;
        }
        #tournamentLogoPreview {
            display: block;
            margin: 10px auto;
            max-width: 150px;
            max-height: 150px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        nav {
            background-color: #ffffff;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            overflow-x: auto;
            white-space: nowrap;
        }
        nav button {
            padding: 10px 20px;
            margin: 5px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        nav button:hover {
            background-color: #0056b3;
        }
        .tab {
            display: none;
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .tab.active {
            display: block;
        }
        form {
            display: grid;
            gap: 15px;
            max-width: 800px;
            margin: 0 auto;
        }
        label {
            font-weight: 500;
            margin-bottom: 5px;
            display: block;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        input:focus, select:focus, textarea:focus {
            border-color: #007bff;
            outline: none;
            box-shadow: 0 0 5px rgba(0,123,255,0.3);
        }
        button[type="submit"], button[type="button"] {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button[type="submit"]:hover, button[type="button"]:hover {
            background-color: #0056b3;
        }
        .delete-button {
            background-color: #dc3545;
        }
        .delete-button:hover {
            background-color: #c82333;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: #fff;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f8f9fa;
            font-weight: 700;
        }
        .table-container {
            overflow-x: auto;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
        }
        .modal-content {
            background: white;
            margin: 10% auto;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .modal-content form {
            display: grid;
            gap: 10px;
        }
        .modal-content button {
            margin-top: 10px;
        }
        #groupAssignment {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .group-box {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 5px;
            min-width: 200px;
            min-height: 100px;
        }
        .team-list {
            list-style-type: none;
            padding: 0;
            min-height: 50px;
        }
        .team-list li {
            margin-bottom: 5px;
            cursor: pointer;
            padding: 5px;
            background-color: #f9f9f9;
            border-radius: 3px;
        }
        .team-list li.dragging {
            opacity: 0.5;
            background-color: #f0f0f0;
        }
        .team-list li.selected {
            background-color: #007bff;
            color: white;
        }
        @media (max-width: 768px) {
            body { padding: 10px; }
            h1 { font-size: 24px; }
            nav { padding: 5px; }
            nav button { font-size: 14px; padding: 8px 12px; margin: 3px; }
            .tab { padding: 15px; }
            input, select, textarea { font-size: 14px; padding: 8px; }
            button[type="submit"], button[type="button"] { font-size: 14px; padding: 8px 16px; }
            .modal-content { margin: 20% auto; width: 95%; }
            #tournamentLogoPreview { max-width: 100px; max-height: 100px; }
        }
        @media (max-width: 480px) {
            nav { display: flex; flex-wrap: nowrap; overflow-x: auto; }
            nav button { flex: 0 0 auto; }
            th, td { font-size: 12px; padding: 8px; }
        }
    </style>
</head>
<body>
    <div id="resultModal" class="modal">
        <div class="modal-content">
            <h2>Nh·∫≠p K·∫øt Qu·∫£ Tr·∫≠n ƒê·∫•u</h2>
            <form id="resultForm">
                <div>
                    <label>ƒê·ªôi A</label>
                    <input type="number" min="0" name="teamASet1" placeholder="Set 1">
                    <input type="number" min="0" name="teamASet2" placeholder="Set 2">
                    <input type="number" min="0" name="teamASet3" placeholder="Set 3">
                </div>
                <div>
                    <label>ƒê·ªôi B</label>
                    <input type="number" min="0" name="teamBSet1" placeholder="Set 1">
                    <input type="number" min="0" name="teamBSet2" placeholder="Set 2">
                    <input type="number" min="0" name="teamBSet3" placeholder="Set 3">
                </div>
                <button type="button" onclick="document.getElementById('resultModal').style.display='none'">H·ªßy</button>
                <button type="submit">L∆∞u K·∫øt Qu·∫£</button>
            </form>
        </div>
    </div>

    <div id="editPlayerModal" class="modal">
        <div class="modal-content">
            <h2>S·ª≠a Th√¥ng tin Ng∆∞·ªùi ch∆°i</h2>
            <form id="editPlayerForm">
                <input type="hidden" id="editPlayerIndex">
                <div>
                    <label>T√™n</label>
                    <input id="editPlayerName" type="text" required>
                </div>
                <div>
                    <label>Gi·ªõi t√≠nh</label>
                    <select id="editPlayerGender"><option>Nam</option><option>N·ªØ</option></select>
                </div>
                <div>
                    <label>Rating</label>
                    <input id="editPlayerRating" type="number" min="0" step="0.1">
                </div>
                <div>
                    <label>Email</label>
                    <input id="editPlayerEmail" type="email">
                </div>
                <button type="button" onclick="document.getElementById('editPlayerModal').style.display='none'">H·ªßy</button>
                <button type="button" onclick="saveEditPlayer()">L∆∞u</button>
            </form>
        </div>
    </div>

    <div id="editTeamModal" class="modal">
        <div class="modal-content">
            <h2>S·ª≠a Th√¥ng tin ƒê·ªôi</h2>
            <form id="editTeamForm">
                <input type="hidden" id="editTeamIndex">
                <div>
                    <label>T√™n ƒê·ªôi</label>
                    <input id="editTeamName" type="text" required>
                </div>
                <div>
                    <label>N·ªôi dung thi ƒë·∫•u</label>
                    <select id="editTeamMatchType" required>
                        <option value="mm">Nam - Nam</option>
                        <option value="mf">Nam - N·ªØ</option>
                        <option value="ff">N·ªØ - N·ªØ</option>
                        <option value="mixed_mm_mf">H·ªón h·ª£p Nam - Nam + Nam - N·ªØ</option>
                    </select>
                </div>
                <div>
                    <label>Ch·ªçn Ng∆∞·ªùi ch∆°i</label>
                    <select id="editTeamPlayers" multiple></select>
                </div>
                <button type="button" onclick="document.getElementById('editTeamModal').style.display='none'">H·ªßy</button>
                <button type="button" onclick="saveEditTeam()">L∆∞u</button>
            </form>
        </div>
    </div>

    <h1>Pickleball Tournament V11.3.0</h1>
    <img id="tournamentLogoPreview" alt="Logo Preview" style="display: none;">
    <nav>
        <button onclick="showTab('config')">1. C·∫•u h√¨nh & S√¢n</button>
        <button onclick="showTab('players')">2. Ng∆∞·ªùi ch∆°i & ƒê·ªôi</button>
        <button onclick="showTab('schedule')">3. L·ªãch Tr·∫≠n ƒë·∫•u</button>
        <button onclick="showTab('track')">üî¥ Theo D√µi & Nh·∫≠p ƒëi·ªÉm</button>
        <button onclick="showTab('rankings')">4. X·∫øp H·∫°ng & V√≤ng KO</button>
        <button onclick="showTab('finance')">5. T√†i tr·ª£ & Thu chi</button>
        <button onclick="showTab('test')">Test & Random</button>
        <button onclick="exportTournament()">Xu·∫•t Gi·∫£i (JSON)</button>
        <button onclick="loadTournament()">T·∫£i Gi·∫£i</button>
    </nav>

    <div id="config" class="tab">
        <h2>1. Th√¥ng tin Gi·∫£i ƒë·∫•u & BTC</h2>
        <form id="tournamentForm">
            <div>
                <label>T√™n Gi·∫£i ƒë·∫•u</label>
                <input id="tournamentName" type="text" required placeholder="Nh·∫≠p t√™n gi·∫£i ƒë·∫•u">
            </div>
            <div>
                <label>Ng√†y t·ªï ch·ª©c</label>
                <input id="tournamentDate" type="date" required>
            </div>
            <div>
                <label>Lu·∫≠t thi ƒë·∫•u (T√≥m t·∫Øt)</label>
                <textarea id="tournamentRules" required placeholder="Nh·∫≠p t√≥m t·∫Øt lu·∫≠t"></textarea>
            </div>
            <div>
                <label>S·ªë ng∆∞·ªùi t·ªëi ƒëa m·ªói ƒê·ªôi</label>
                <input id="maxPlayersPerTeam" type="number" min="2" value="2" readonly>
            </div>
            <div>
                <label>S·ªë ƒë·ªôi t·ªëi ƒëa m·ªói B·∫£ng (V√≤ng b·∫£ng)</label>
                <input id="maxTeamsPerGroup" type="number" min="1" required>
            </div>
            <h3>Ban T·ªï Ch·ª©c</h3>
            <table id="btcTable">
                <tr><th>T√™n</th><th>Vai tr√≤</th><th>SƒêT</th><th>Email</th><th>H√†nh ƒë·ªông</th></tr>
            </table>
            <div>
                <label>T√™n</label>
                <input id="btcName" type="text">
                <label>Vai tr√≤</label>
                <input id="btcRole" type="text">
                <label>SƒêT</label>
                <input id="btcPhone" type="tel">
                <label>Email</label>
                <input id="btcEmail" type="email">
                <button type="button" onclick="addBtc()">Th√™m</button>
            </div>
            <button type="button" onclick="saveTournamentConfig()">L∆∞u C·∫•u h√¨nh Chung</button>
        </form>

        <h2>2. Th√¥ng tin S√¢n thi ƒë·∫•u & L·ªá ph√≠</h2>
        <form>
            <h3>S√¢n thi ƒë·∫•u</h3>
            <div>
                <label>T√™n S√¢n/ƒê·ªãa ƒëi·ªÉm</label>
                <input type="text" required>
            </div>
            <div>
                <label>ƒê·ªãa ch·ªâ chi ti·∫øt</label>
                <input type="text" required>
            </div>
            <div>
                <label>Link Google Map</label>
                <input type="url" placeholder="https://maps.google.com/...">
            </div>
            <div>
                <label>Ng∆∞·ªùi li√™n h·ªá</label>
                <input type="text">
            </div>
            <div>
                <label>SƒêT li√™n h·ªá</label>
                <input type="tel">
            </div>
            <h3>L·ªá ph√≠ & Thanh to√°n</h3>
            <div>
                <label>S·ªë ti·ªÅn L·ªá ph√≠/ƒê·ªôi (VNƒê)</label>
                <input type="number" min="0">
                <p>ƒê√¢y l√† kho·∫£n thu s·∫Ω t·ª± ƒë·ªông th√™m v√†o m·ª•c Thu chi.</p>
            </div>
            <div>
                <label>Upload QR Code Thanh to√°n</label>
                <input type="file" accept="image/*">
            </div>
            <div>
                <label>QR Code Preview</label>
                <img src="" alt="QR Code Preview">
            </div>
            <button type="submit">L∆∞u Th√¥ng tin S√¢n & L·ªá ph√≠</button>
        </form>
    </div>

    <div id="players" class="tab">
        <h2>1. Danh s√°ch Ng∆∞·ªùi ch∆°i / ƒêƒÉng k√Ω</h2>
        <form id="playerForm">
            <div>
                <label>T√™n</label>
                <input id="playerName" type="text" required>
                <label>Gi·ªõi t√≠nh</label>
                <select id="playerGender"><option>Nam</option><option>N·ªØ</option></select>
                <label>Rating</label>
                <input id="playerRating" type="number" min="0" step="0.1">
                <label>Email</label>
                <input id="playerEmail" type="email">
                <button type="button" onclick="addPlayer()">Th√™m</button>
            </div>
        </form>
        <p id="totalPlayers">T·ªïng s·ªë ng∆∞·ªùi ch∆°i: 0</p>
        <button>·∫®n/Hi·ªán Danh s√°ch Chi ti·∫øt</button>
        <div class="table-container">
            <table id="playersTable">
                <tr><th>STT</th><th>T√™n</th><th>Gi·ªõi t√≠nh</th><th>Rating</th><th>Email</th><th>H√†nh ƒë·ªông</th></tr>
            </table>
        </div>

        <h2>2. Qu·∫£n l√Ω ƒê·ªôi thi ƒë·∫•u</h2>
        <p>S·ª≠ d·ª•ng Rating trung b√¨nh ƒë·ªÉ s·∫Øp x·∫øp ƒë·ªôi (s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t khi th√™m th√†nh vi√™n).</p>
        <form id="teamForm">
            <div>
                <label>T√™n ƒê·ªôi</label>
                <input id="teamName" type="text" required>
                <label>N·ªôi dung thi ƒë·∫•u</label>
                <select id="teamMatchType" required>
                    <option value="mm">Nam - Nam</option>
                    <option value="mf">Nam - N·ªØ</option>
                    <option value="ff">N·ªØ - N·ªØ</option>
                    <option value="mixed_mm_mf">H·ªón h·ª£p Nam - Nam + Nam - N·ªØ</option>
                </select>
                <label>Ch·ªçn Ng∆∞·ªùi ch∆°i</label>
                <select id="teamPlayers" multiple></select>
                <button type="button" onclick="addTeam()">Th√™m ƒê·ªôi</button>
            </div>
        </form>
        <div>
            <label>Lo·∫°i ƒê·ªôi Ng·∫´u nhi√™n</label>
            <select id="randomTeamType">
                <option value="mm">Nam - Nam</option>
                <option value="mf">Nam - N·ªØ</option>
                <option value="ff">N·ªØ - N·ªØ</option>
                <option value="mixed_mm_mf">H·ªón h·ª£p Nam - Nam + Nam - N·ªØ</option>
            </select>
            <button onclick="generateRandomTeam(document.getElementById('randomTeamType').value)">T·∫°o ƒê·ªôi Ng·∫´u nhi√™n</button>
        </div>
        <p id="totalTeams">T·ªïng s·ªë ƒë·ªôi: 0</p>
        <div class="table-container">
            <table id="teamsTable">
                <tr><th>STT</th><th>T√™n ƒê·ªôi</th><th>Th√†nh vi√™n</th><th>N·ªôi dung</th><th>Rating TB</th><th>H√†nh ƒë·ªông</th></tr>
            </table>
        </div>
    </div>

    <div id="schedule" class="tab">
        <h2>1. Chia B·∫£ng & T·∫°o Tr·∫≠n ƒë·∫•u V√≤ng B·∫£ng</h2>
        <button>Chia B·∫£ng T·ª± ƒë·ªông</button>
        <button>Chia B·∫£ng B·∫±ng Tay</button>
        <button>Chia B·∫£ng K·∫øt H·ª£p</button>
        <button>T·∫°o L·ªãch Tr·∫≠n ƒë·∫•u</button>
        <p>T·ªïng s·ªë b·∫£ng: 0 | T·ªïng s·ªë tr·∫≠n: 0</p>

        <h2>2. Danh s√°ch Tr·∫≠n ƒë·∫•u (V√≤ng B·∫£ng)</h2>
        <div class="table-container">
            <table>
                <tr><th>B·∫£ng</th><th>Tr·∫≠n</th><th>ƒê·ªôi A</th><th>ƒê·ªôi B</th><th>K·∫øt qu·∫£ (Sets)</th><th>Ng∆∞·ªùi th·∫Øng</th><th>H√†nh ƒë·ªông (Nh·∫≠p ƒëi·ªÉm)</th></tr>
            </table>
        </div>
    </div>

    <div id="track" class="tab">
        <h2>üî¥ Theo D√µi & Nh·∫≠p K·∫øt Qu·∫£ Nhanh (Tr·∫≠n ƒë·∫•u ch∆∞a ho√†n th√†nh)</h2>
        <form>
            <select>
                <option>T·∫•t c·∫£ c√°c lo·∫°i</option>
                <option>V√≤ng b·∫£ng</option>
                <option>V√≤ng lo·∫°i tr·ª±c ti·∫øp</option>
            </select>
            <input type="text" placeholder="T√¨m ki·∫øm tr·∫≠n ƒë·∫•u">
        </form>
        <p>Kh√¥ng c√≥ tr·∫≠n ƒë·∫•u ƒëang ch·ªù k·∫øt qu·∫£.</p>
    </div>

    <div id="rankings" class="tab">
        <h2>1. C·∫•u h√¨nh V√≤ng lo·∫°i tr·ª±c ti·∫øp (KO)</h2>
        <p>Sau khi ho√†n th√†nh v√≤ng b·∫£ng, nh·∫•n <b>"L·ª±a ch·ªçn ƒê·ªôi & T·∫°o V√≤ng KO"</b>.</p>
        <form>
            <div>
                <label>S·ªë ƒë·ªôi v√†o V√≤ng KO t·ª´ m·ªói b·∫£ng</label>
                <input id="num_teams_per_group" type="number" min="1" required>
            </div>
            <div>
                <label>K√≠ch th∆∞·ªõc V√≤ng KO (VD: 8, 16, 32)</label>
                <input id="ko_size" type="number" min="8" step="8" required>
            </div>
            <h3>C·∫•u h√¨nh Sets Scoring cho V√≤ng KO</h3>
            <div>
                <h4>C·∫•u h√¨nh M·∫∑c ƒë·ªãnh (T·∫•t c·∫£ c√°c v√≤ng)</h4>
                <label>Sets (Best of)</label>
                <input type="number" min="1">
                <label>Target Points</label>
                <input type="number" min="1">
                <label>Rule</label>
                <select>
                    <option>Win by 2 (VD: 11-9)</option>
                    <option>Ch·∫°m m·ªëc (VD: 11-10)</option>
                </select>
            </div>
            <div>
                <h4>C·∫•u h√¨nh B√°n k·∫øt (N·∫øu kh√°c M·∫∑c ƒë·ªãnh)</h4>
                <label>Sets (Best of)</label>
                <input type="number" min="1">
                <label>Target Points</label>
                <input type="number" min="1">
                <label>Rule</label>
                <select>
                    <option>D√πng M·∫∑c ƒë·ªãnh</option>
                    <option>Win by 2</option>
                    <option>Ch·∫°m m·ªëc</option>
                </select>
            </div>
            <div>
                <h4>C·∫•u h√¨nh Chung k·∫øt (N·∫øu kh√°c M·∫∑c ƒë·ªãnh)</h4>
                <label>Sets (Best of)</label>
                <input type="number" min="1">
                <label>Target Points</label>
                <input type="number" min="1">
                <label>Rule</label>
                <select>
                    <option>D√πng M·∫∑c ƒë·ªãnh</option>
                    <option>Win by 2</option>
                    <option>Ch·∫°m m·ªëc</option>
                </select>
            </div>
            <button type="submit">L∆∞u C·∫•u h√¨nh KO</button>
            <button type="button">L·ª±a ch·ªçn ƒê·ªôi & T·∫°o V√≤ng KO</button>
        </form>

        <h2>2. C√¢y Thi ƒë·∫•u V√≤ng KO</h2>
        <p>C√¢y thi ƒë·∫•u s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã sau khi t·∫°o V√≤ng KO.</p>

        <h2>3. X·∫øp h·∫°ng Chung cu·ªôc</h2>
        <p>X·∫øp h·∫°ng s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã sau khi ho√†n th√†nh V√≤ng KO.</p>
    </div>

    <div id="finance" class="tab">
        <h2>1. Danh s√°ch Nh√† T√†i Tr·ª£</h2>
        <form>
            <div>
                <label>T√™n Nh√† t√†i tr·ª£</label>
                <input type="text">
                <label>S·ªë ti·ªÅn</label>
                <input type="number" min="0">
                <label>Upload Logo</label>
                <input type="file" accept="image/*">
                <button type="button">Th√™m</button>
            </div>
        </form>
        <p>T·ªïng ti·ªÅn t√†i tr·ª£: 0</p>

        <h2>2. K·∫ø ho·∫°ch Thu chi Gi·∫£i ƒë·∫•u</h2>
        <button>T√≠nh l·∫°i T·ªïng k·∫øt</button>
        <div class="table-container">
            <table>
                <tr><th>M·ª•c chi ph√≠/doanh thu</th><th>D·ª± ki·∫øn (VNƒê)</th><th>Th·ª±c t·∫ø (VNƒê)</th><th>Lo·∫°i</th><th>H√†nh ƒë·ªông</th></tr>
                <tr>
                    <td><input type="text"></td>
                    <td><input type="number" min="0"></td>
                    <td><input type="number" min="0"></td>
                    <td><select><option>Thu</option><option>Chi</option></select></td>
                    <td><button type="button">Th√™m</button></td>
                </tr>
            </table>
        </div>
        <div>
            <p>T·ªïng Doanh thu D·ª± ki·∫øn: 0</p>
            <p>T·ªïng Chi ph√≠ D·ª± ki·∫øn: 0</p>
            <p>L·ª£i nhu·∫≠n D·ª± ki·∫øn: 0</p>
            <p>T·ªïng Doanh thu Th·ª±c t·∫ø: 0</p>
            <p>T·ªïng Chi ph√≠ Th·ª±c t·∫ø: 0</p>
            <p>L·ª£i nhu·∫≠n Th·ª±c t·∫ø: 0</p>
        </div>
    </div>

    <div id="test" class="tab">
        <h2>1. Ch·ª©c nƒÉng Test & T·∫°o d·ªØ li·ªáu ng·∫´u nhi√™n</h2>
        <button onclick="generateRandomPlayers(20)">T·∫°o 20 Ng∆∞·ªùi ch∆°i Ng·∫´u nhi√™n</button>
        <button onclick="generateRandomTeams(10)">T·∫°o 10 ƒê·ªôi Ng·∫´u nhi√™n</button>
        <button onclick="generateRandomGroupResults()">T·∫°o K·∫øt qu·∫£ V√≤ng B·∫£ng Ng·∫´u nhi√™n</button>
        <button onclick="generateRandomKOResults()">T·∫°o K·∫øt qu·∫£ KO Ng·∫´u nhi√™n</button>
        <p>* C√°c ch·ª©c nƒÉng n√†y ch·ªâ d√πng ƒë·ªÉ ki·ªÉm tra, s·∫Ω ghi ƒë√® d·ªØ li·ªáu hi·ªán t·∫°i.</p>

        <h2>1.1 T·∫°o D·ªØ li·ªáu M·∫´u Random</h2>
        <button onclick="generateRandomTournament()">T·∫°o D·ªØ li·ªáu M·∫´u Th√¥ng tin Gi·∫£i ƒê·∫•u</button>
        <button onclick="generateRandomBTC()">T·∫°o Danh s√°ch M·∫´u Ban T·ªï Ch·ª©c</button>
        <div>
            <label>S·ªë l∆∞·ª£ng Ng∆∞·ªùi ch∆°i</label>
            <input id="numPlayers" type="number" min="1" value="20">
            <button onclick="generateRandomPlayers(document.getElementById('numPlayers').value)">T·∫°o Ng∆∞·ªùi ch∆°i Ng·∫´u nhi√™n</button>
        </div>

        <h2>2. Xu·∫•t d·ªØ li·ªáu gi·∫£i ƒë·∫•u (CSV)</h2>
        <button onclick="exportCSV('btc')">Xu·∫•t BTC</button>
        <button onclick="exportCSV('players')">Xu·∫•t Ng∆∞·ªùi ch∆°i</button>
        <button onclick="exportCSV('teams')">Xu·∫•t ƒê·ªôi</button>
        <button onclick="exportCSV('sponsors')">Xu·∫•t T√†i tr·ª£</button>
        <button onclick="exportCSV('finance')">Xu·∫•t Thu chi</button>
        <button onclick="exportCSV('schedule')">Xu·∫•t L·ªãch thi ƒë·∫•u</button>

        <h2>3. Import d·ªØ li·ªáu gi·∫£i ƒë·∫•u (CSV)</h2>
        <div>
            <label>Import BTC</label>
            <input type="file" id="import_btc" accept=".csv">
            <button onclick="importCSV('btc')">Import</button>
        </div>
        <div>
            <label>Import Ng∆∞·ªùi ch∆°i</label>
            <input type="file" id="import_players" accept=".csv">
            <button onclick="importCSV('players')">Import</button>
        </div>
        <div>
            <label>Import ƒê·ªôi</label>
            <input type="file" id="import_teams" accept=".csv">
            <button onclick="importCSV('teams')">Import</button>
        </div>
        <div>
            <label>Import T√†i tr·ª£</label>
            <input type="file" id="import_sponsors" accept=".csv">
            <button onclick="importCSV('sponsors')">Import</button>
        </div>
        <div>
            <label>Import Thu chi</label>
            <input type="file" id="import_finance" accept=".csv">
            <button onclick="importCSV('finance')">Import</button>
        </div>
        <div>
            <label>Import L·ªãch thi ƒë·∫•u</label>
            <input type="file" id="import_schedule" accept=".csv">
            <button onclick="importCSV('schedule')">Import</button>
        </div>

        <h2>4. Xu·∫•t/Import to√†n b·ªô th√¥ng tin gi·∫£i ƒë·∫•u (JSON)</h2>
        <button onclick="exportFullTournamentJSON()">Xu·∫•t To√†n b·ªô Gi·∫£i (JSON)</button>
        <div>
            <label>Import To√†n b·ªô Gi·∫£i</label>
            <input type="file" id="import_full" accept=".json">
            <button onclick="importFullTournamentJSON()">Import</button>
        </div>

        <h2>5. X√≥a D·ªØ li·ªáu Theo Ph·∫ßn</h2>
        <p>* X√≥a d·ªØ li·ªáu t·ª´ng ph·∫ßn v·ªõi r√†ng bu·ªôc x√°c nh·∫≠n. L∆∞u √Ω: Kh√¥ng th·ªÉ ho√†n t√°c, v√† c√≥ th·ªÉ ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c ph·∫ßn ph·ª• thu·ªôc (v√≠ d·ª•: x√≥a ng∆∞·ªùi ch∆°i c√≥ th·ªÉ ·∫£nh h∆∞·ªüng ƒë·∫øn ƒë·ªôi).</p>
        <button class="delete-button" onclick="deleteSection('btc')">X√≥a BTC</button>
        <button class="delete-button" onclick="deleteSection('players')">X√≥a Ng∆∞·ªùi ch∆°i</button>
        <button class="delete-button" onclick="deleteSection('teams')">X√≥a ƒê·ªôi</button>
        <button class="delete-button" onclick="deleteSection('sponsors')">X√≥a T√†i tr·ª£</button>
        <button class="delete-button" onclick="deleteSection('finance')">X√≥a Thu chi</button>
        <button class="delete-button" onclick="deleteSection('schedule')">X√≥a L·ªãch thi ƒë·∫•u</button>

        <h2>6. Kh√°c</h2>
        <button class="delete-button" onclick="clearAllData()">X√≥a To√†n b·ªô D·ªØ li·ªáu Gi·∫£i ƒë·∫•u</button>
        <p>X√≥a t·∫•t c·∫£ d·ªØ li·ªáu ƒë√£ l∆∞u tr·ªØ (kh√¥ng th·ªÉ ho√†n t√°c).</p>
    </div>

    <script>
        // H√†m hi·ªÉn th·ªã tab
        function showTab(tabId) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
        }

        // H√†m validate c·∫•u h√¨nh v√≤ng KO
        function validateKO() {
            const koSize = parseInt(document.getElementById('ko_size').value);
            if (koSize < 8 || koSize % 8 !== 0) {
                alert('K√≠ch th∆∞·ªõc V√≤ng KO ph·∫£i l√† b·ªôi c·ªßa 8 (VD: 8, 16, 32).');
                return false;
            }
            return true;
        }

        // H√†m c·∫≠p nh·∫≠t favicon
        function updateFavicon(logoData) {
            const favicon = document.getElementById('favicon');
            if (logoData) {
                favicon.href = logoData;
            } else {
                favicon.href = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABUSURBVFhH7Y5BDgAhDAO7/f9/fQ2MIBsHLvJ0gDIiAOB3t4Du7h3Q3b0Dujs3gO7uHdDdHVB3dwfo7t4B3d0doLt7B3R37wDu7h3Q3b0Dujs3gO7uHdDdHVD37wEYSG4l9O8CggAAAABJRU5ErkJggg==';
            }
        }

        // H√†m x·ª≠ l√Ω t·∫£i l√™n logo
        function handleLogoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const logoData = e.target.result;
                    document.getElementById('tournamentLogoPreview').src = logoData;
                    document.getElementById('tournamentLogoPreview').style.display = 'block';
                    updateFavicon(logoData);
                    const config = JSON.parse(localStorage.getItem('tournamentConfig') || '{}');
                    config.logo = logoData;
                    localStorage.setItem('tournamentConfig', JSON.stringify(config));
                };
                reader.readAsDataURL(file);
            }
        }

        // H√†m x·ª≠ l√Ω t·∫£i l√™n QR code
        function handleQRUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const qrData = e.target.result;
                    document.getElementById('paymentQRPreview').src = qrData;
                    document.getElementById('paymentQRPreview').style.display = 'block';
                    const config = JSON.parse(localStorage.getItem('tournamentConfig') || '{}');
                    config.paymentQR = qrData;
                    localStorage.setItem('tournamentConfig', JSON.stringify(config));
                };
                reader.readAsDataURL(file);
            }
        }

        // H√†m l∆∞u c·∫•u h√¨nh gi·∫£i ƒë·∫•u v√† s√¢n thi ƒë·∫•u
        function saveTournamentConfig() {
            const venueMapLink = document.getElementById('venueMapLink').value.trim();
            const venueContactPhone = document.getElementById('venueContactPhone').value.trim();
            const registrationFee = parseFloat(document.getElementById('registrationFee').value) || 0;

            // Validation
            if (!document.getElementById('tournamentName').value.trim()) {
                alert('T√™n gi·∫£i ƒë·∫•u l√† b·∫Øt bu·ªôc!');
                return;
            }
            if (!document.getElementById('tournamentDate').value) {
                alert('Ng√†y t·ªï ch·ª©c l√† b·∫Øt bu·ªôc!');
                return;
            }
            if (!document.getElementById('tournamentRules').value.trim()) {
                alert('Lu·∫≠t thi ƒë·∫•u l√† b·∫Øt bu·ªôc!');
                return;
            }
            if (!document.getElementById('maxTeamsPerGroup').value) {
                alert('S·ªë ƒë·ªôi t·ªëi ƒëa m·ªói b·∫£ng l√† b·∫Øt bu·ªôc!');
                return;
            }
            if (!document.getElementById('venueName').value.trim()) {
                alert('T√™n s√¢n/ƒë·ªãa ƒëi·ªÉm l√† b·∫Øt bu·ªôc!');
                return;
            }
            if (!document.getElementById('venueAddress').value.trim()) {
                alert('ƒê·ªãa ch·ªâ chi ti·∫øt l√† b·∫Øt bu·ªôc!');
                return;
            }
            if (venueMapLink && !/^https?:\/\/(www\.)?google\.com\/maps/.test(venueMapLink)) {
                alert('Link Google Map kh√¥ng h·ª£p l·ªá!');
                return;
            }
            if (venueContactPhone && !/^\+?\d{9,12}$/.test(venueContactPhone)) {
                alert('S·ªë ƒëi·ªán tho·∫°i li√™n h·ªá kh√¥ng h·ª£p l·ªá!');
                return;
            }
            if (registrationFee < 0) {
                alert('L·ªá ph√≠ kh√¥ng ƒë∆∞·ª£c √¢m!');
                return;
            }

            const config = {
                name: document.getElementById('tournamentName').value.trim(),
                date: document.getElementById('tournamentDate').value,
                rules: document.getElementById('tournamentRules').value.trim(),
                maxPlayersPerTeam: parseInt(document.getElementById('maxPlayersPerTeam').value) || 2,
                maxTeamsPerGroup: parseInt(document.getElementById('maxTeamsPerGroup').value) || 4,
                logo: document.getElementById('tournamentLogoPreview').src,
                venue: {
                    name: document.getElementById('venueName').value.trim(),
                    address: document.getElementById('venueAddress').value.trim(),
                    mapLink: venueMapLink,
                    contactPerson: document.getElementById('venueContactPerson').value.trim(),
                    contactPhone: venueContactPhone
                },
                registrationFee: registrationFee,
                paymentQR: document.getElementById('paymentQRPreview').src
            };
            localStorage.setItem('tournamentConfig', JSON.stringify(config));
            loadVenueTable();
            alert('ƒê√£ l∆∞u c·∫•u h√¨nh gi·∫£i ƒë·∫•u v√† s√¢n thi ƒë·∫•u!');
        }

        // H√†m t·∫£i c·∫•u h√¨nh gi·∫£i ƒë·∫•u v√† s√¢n thi ƒë·∫•u
        function loadTournamentConfig() {
            const config = JSON.parse(localStorage.getItem('tournamentConfig') || '{}');
            if (config) {
                document.getElementById('tournamentName').value = config.name || '';
                document.getElementById('tournamentDate').value = config.date || '';
                document.getElementById('tournamentRules').value = config.rules || '';
                document.getElementById('maxPlayersPerTeam').value = config.maxPlayersPerTeam || 2;
                document.getElementById('maxTeamsPerGroup').value = config.maxTeamsPerGroup || '';
                if (config.logo) {
                    document.getElementById('tournamentLogoPreview').src = config.logo;
                    document.getElementById('tournamentLogoPreview').style.display = 'block';
                    updateFavicon(config.logo);
                }
                if (config.venue) {
                    document.getElementById('venueName').value = config.venue.name || '';
                    document.getElementById('venueAddress').value = config.venue.address || '';
                    document.getElementById('venueMapLink').value = config.venue.mapLink || '';
                    document.getElementById('venueContactPerson').value = config.venue.contactPerson || '';
                    document.getElementById('venueContactPhone').value = config.venue.contactPhone || '';
                }
                document.getElementById('registrationFee').value = config.registrationFee || '';
                if (config.paymentQR) {
                    document.getElementById('paymentQRPreview').src = config.paymentQR;
                    document.getElementById('paymentQRPreview').style.display = 'block';
                }
                loadVenueTable();
            }
        }

        // H√†m t·∫£i b·∫£ng th√¥ng tin s√¢n thi ƒë·∫•u
        function loadVenueTable() {
            const table = document.getElementById('venueTable');
            table.innerHTML = '<tr><th>T√™n S√¢n</th><th>ƒê·ªãa ch·ªâ</th><th>Link Google Map</th><th>Ng∆∞·ªùi li√™n h·ªá</th><th>SƒêT li√™n h·ªá</th></tr>';
            const config = JSON.parse(localStorage.getItem('tournamentConfig') || '{}');
            if (config.venue) {
                const row = table.insertRow();
                row.innerHTML = `
                    <td>${config.venue.name || ''}</td>
                    <td>${config.venue.address || ''}</td>
                    <td><a href="${config.venue.mapLink || '#'}" target="_blank">${config.venue.mapLink ? 'Xem b·∫£n ƒë·ªì' : ''}</a></td>
                    <td>${config.venue.contactPerson || ''}</td>
                    <td>${config.venue.contactPhone || ''}</td>
                `;
            } else {
                const row = table.insertRow();
                row.innerHTML = `<td colspan="5" class="no-data">Ch∆∞a c√≥ th√¥ng tin s√¢n thi ƒë·∫•u.</td>`;
            }
        }

        // M·∫£ng t√™n Vi·ªát Nam m·∫´u
        const vietnameseNames = [
            'Nguy·ªÖn VƒÉn', 'Tr·∫ßn Th·ªã', 'L√™ VƒÉn', 'Ph·∫°m Th·ªã', 'V≈© VƒÉn', 'Ho√†ng Th·ªã', 'B√πi VƒÉn', 'ƒê·∫∑ng Th·ªã', 'Ng√¥ VƒÉn', 'ƒê·ªó Th·ªã',
            'Tr·∫ßn VƒÉn', 'Nguy·ªÖn Th·ªã', 'Phan VƒÉn', 'L√Ω Th·ªã', 'H·ªì VƒÉn', 'V√µ Th·ªã', 'ƒêo√†n VƒÉn', 'ƒêinh Th·ªã', 'T√¥ VƒÉn', 'B√πi Th·ªã'
        ];

        // M·∫£ng vai tr√≤ BTC m·∫´u
        const btcRoles = ['Tr∆∞·ªüng BTC', 'Ph√≥ BTC', 'Th∆∞ k√Ω', 'Tr·ªçng t√†i ch√≠nh', 'Tr·ª£ l√Ω'];

        // H√†m t·∫°o d·ªØ li·ªáu m·∫´u th√¥ng tin gi·∫£i ƒë·∫•u
        function generateRandomTournament() {
            document.getElementById('tournamentName').value = 'Gi·∫£i Pickleball Random ' + Math.floor(Math.random() * 1000);
            document.getElementById('tournamentDate').value = new Date(Date.now() + Math.floor(Math.random() * 30 * 24 * 60 * 60 * 1000)).toISOString().split('T')[0];
            document.getElementById('tournamentRules').value = 'Lu·∫≠t thi ƒë·∫•u m·∫´u: Best of 3 sets, win by 2 points.';
            document.getElementById('maxPlayersPerTeam').value = 2;
            document.getElementById('maxTeamsPerGroup').value = Math.floor(Math.random() * 4) + 4;
            document.getElementById('venueName').value = 'S√¢n Pickleball ' + Math.floor(Math.random() * 100);
            document.getElementById('venueAddress').value = '123 ƒê∆∞·ªùng Gi·∫£i ƒê·∫•u, Qu·∫≠n 1, TP.HCM';
            document.getElementById('venueMapLink').value = 'https://maps.google.com/maps?q=123+ƒê∆∞·ªùng+Gi·∫£i+ƒê·∫•u';
            document.getElementById('venueContactPerson').value = vietnameseNames[Math.floor(Math.random() * vietnameseNames.length)];
            document.getElementById('venueContactPhone').value = '0' + Math.floor(Math.random() * 1000000000).toString().padStart(9, '0');
            document.getElementById('registrationFee').value = Math.floor(Math.random() * 1000000);
            document.getElementById('tournamentLogoPreview').style.display = 'none';
            document.getElementById('paymentQRPreview').style.display = 'none';
            saveTournamentConfig();
            alert('ƒê√£ t·∫°o d·ªØ li·ªáu m·∫´u th√¥ng tin gi·∫£i ƒë·∫•u!');
        }

        // H√†m t·∫°o danh s√°ch m·∫´u BTC
        function generateRandomBTC() {
            const btcList = [];
            for (let i = 0; i < 5; i++) {
                btcList.push({
                    name: vietnameseNames[Math.floor(Math.random() * vietnameseNames.length)] + ' ' + String.fromCharCode(65 + i),
                    role: btcRoles[Math.floor(Math.random() * btcRoles.length)],
                    phone: '0' + Math.floor(Math.random() * 1000000000).toString().padStart(9, '0'),
                    email: 'btc' + i + '@example.com'
                });
            }
            localStorage.setItem('btc', JSON.stringify(btcList));
            loadBtcTable();
            alert('ƒê√£ t·∫°o danh s√°ch m·∫´u ban t·ªï ch·ª©c!');
        }

        // H√†m t·∫£i b·∫£ng BTC
        function loadBtcTable() {
            const table = document.getElementById('btcTable');
            table.innerHTML = '<tr><th>T√™n</th><th>Vai tr√≤</th><th>SƒêT</th><th>Email</th><th>H√†nh ƒë·ªông</th></tr>';
            const btc = JSON.parse(localStorage.getItem('btc') || '[]');
            btc.forEach((member, index) => {
                const row = table.insertRow();
                row.innerHTML = `<td>${member.name}</td><td>${member.role}</td><td>${member.phone}</td><td>${member.email}</td><td><button onclick="deleteBtc(${index})">X√≥a</button></td>`;
            });
        }

        // H√†m th√™m BTC
        function addBtc() {
            const btc = JSON.parse(localStorage.getItem('btc') || '[]');
            const name = document.getElementById('btcName').value.trim();
            if (!name) {
                alert('T√™n th√†nh vi√™n BTC l√† b·∫Øt bu·ªôc!');
                return;
            }
            btc.push({
                name: name,
                role: document.getElementById('btcRole').value,
                phone: document.getElementById('btcPhone').value,
                email: document.getElementById('btcEmail').value
            });
            localStorage.setItem('btc', JSON.stringify(btc));
            loadBtcTable();
            document.getElementById('btcName').value = '';
            document.getElementById('btcRole').value = '';
            document.getElementById('btcPhone').value = '';
            document.getElementById('btcEmail').value = '';
        }

        // H√†m x√≥a BTC
        function deleteBtc(index) {
            const btc = JSON.parse(localStorage.getItem('btc') || '[]');
            btc.splice(index, 1);
            localStorage.setItem('btc', JSON.stringify(btc));
            loadBtcTable();
        }

        // H√†m t·∫°o ng∆∞·ªùi ch∆°i ng·∫´u nhi√™n
        function generateRandomPlayers(num) {
            const players = [];
            for (let i = 0; i < num; i++) {
                players.push({
                    name: vietnameseNames[Math.floor(Math.random() * vietnameseNames.length)] + ' ' + (i + 1),
                    gender: Math.random() > 0.5 ? 'Nam' : 'N·ªØ',
                    rating: (Math.random() * 4 + 1).toFixed(1),
                    email: 'player' + i + '@example.com'
                });
            }
            localStorage.setItem('players', JSON.stringify(players));
            loadPlayersTable();
            loadPlayerSelect();
            alert(`ƒê√£ t·∫°o ${num} ng∆∞·ªùi ch∆°i ng·∫´u nhi√™n!`);
        }

        // H√†m t·∫£i b·∫£ng ng∆∞·ªùi ch∆°i
        function loadPlayersTable() {
            const table = document.getElementById('playersTable');
            table.innerHTML = '<tr><th>STT</th><th>T√™n</th><th>Gi·ªõi t√≠nh</th><th>Rating</th><th>Email</th><th>H√†nh ƒë·ªông</th></tr>';
            const players = JSON.parse(localStorage.getItem('players') || '[]');
            document.getElementById('totalPlayers').innerText = 'T·ªïng s·ªë ng∆∞·ªùi ch∆°i: ' + players.length;
            players.forEach((player, index) => {
                const row = table.insertRow();
                row.innerHTML = `<td>${index + 1}</td><td>${player.name}</td><td>${player.gender}</td><td>${player.rating}</td><td>${player.email}</td><td><button onclick="editPlayer(${index})">S·ª≠a</button> <button onclick="deletePlayer(${index})">X√≥a</button></td>`;
            });
        }

        // H√†m th√™m ng∆∞·ªùi ch∆°i
        function addPlayer() {
            const name = document.getElementById('playerName').value.trim();
            const rating = parseFloat(document.getElementById('playerRating').value) || 0;
            const email = document.getElementById('playerEmail').value.trim();
            if (!name) {
                alert('T√™n ng∆∞·ªùi ch∆°i l√† b·∫Øt bu·ªôc!');
                return;
            }
            if (rating < 0) {
                alert('Rating ph·∫£i l·ªõn h∆°n ho·∫∑c b·∫±ng 0!');
                return;
            }
            if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                alert('Email kh√¥ng h·ª£p l·ªá!');
                return;
            }
            const players = JSON.parse(localStorage.getItem('players') || '[]');
            players.push({
                name: name,
                gender: document.getElementById('playerGender').value,
                rating: rating,
                email: email
            });
            localStorage.setItem('players', JSON.stringify(players));
            loadPlayersTable();
            loadPlayerSelect();
            document.getElementById('playerForm').reset();
        }

        // H√†m s·ª≠a ng∆∞·ªùi ch∆°i
        function editPlayer(index) {
            const players = JSON.parse(localStorage.getItem('players') || '[]');
            const player = players[index];
            document.getElementById('editPlayerIndex').value = index;
            document.getElementById('editPlayerName').value = player.name;
            document.getElementById('editPlayerGender').value = player.gender;
            document.getElementById('editPlayerRating').value = player.rating;
            document.getElementById('editPlayerEmail').value = player.email;
            document.getElementById('editPlayerModal').style.display = 'block';
        }

        // H√†m l∆∞u s·ª≠a ng∆∞·ªùi ch∆°i v·ªõi validation
        function saveEditPlayer() {
            const index = parseInt(document.getElementById('editPlayerIndex').value);
            const name = document.getElementById('editPlayerName').value.trim();
            const rating = parseFloat(document.getElementById('editPlayerRating').value) || 0;
            const email = document.getElementById('editPlayerEmail').value.trim();
            if (!name) {
                alert('T√™n ng∆∞·ªùi ch∆°i l√† b·∫Øt bu·ªôc!');
                return;
            }
            if (rating < 0) {
                alert('Rating ph·∫£i l·ªõn h∆°n ho·∫∑c b·∫±ng 0!');
                return;
            }
            if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                alert('Email kh√¥ng h·ª£p l·ªá!');
                return;
            }
            const players = JSON.parse(localStorage.getItem('players') || '[]');
            if (players.some((p, i) => p.name === name && i !== index)) {
                alert('T√™n ng∆∞·ªùi ch∆°i ƒë√£ t·ªìn t·∫°i!');
                return;
            }
            players[index] = {
                name: name,
                gender: document.getElementById('editPlayerGender').value,
                rating: rating,
                email: email
            };
            localStorage.setItem('players', JSON.stringify(players));
            document.getElementById('editPlayerModal').style.display = 'none';
            loadPlayersTable();
            loadPlayerSelect();
        }

        // H√†m x√≥a ng∆∞·ªùi ch∆°i
        function deletePlayer(index) {
            const players = JSON.parse(localStorage.getItem('players') || '[]');
            const player = players[index];
            const teams = JSON.parse(localStorage.getItem('teams') || '[]');
            const isInTeam = teams.some(team => team.members.some(member => member.name === player.name));
            if (isInTeam) {
                alert('Kh√¥ng th·ªÉ x√≥a ng∆∞·ªùi ch∆°i v√¨ h·ªç ƒëang thu·ªôc m·ªôt ƒë·ªôi!');
                return;
            }
            players.splice(index, 1);
            localStorage.setItem('players', JSON.stringify(players));
            loadPlayersTable();
            loadPlayerSelect();
        }

        // H√†m t·∫£i select ng∆∞·ªùi ch∆°i cho th√™m/s·ª≠a ƒë·ªôi
        function loadPlayerSelect(selectId = 'teamPlayers') {
            const select = document.getElementById(selectId);
            select.innerHTML = '';
            const players = JSON.parse(localStorage.getItem('players') || '[]');
            const teams = JSON.parse(localStorage.getItem('teams') || '[]');
            const usedPlayerNames = new Set(teams.flatMap(team => team.members.map(member => member.name)));
            players.forEach((player, index) => {
                if (!usedPlayerNames.has(player.name)) {
                    const option = document.createElement('option');
                    option.value = index;
                    option.text = player.name + ' (' + player.gender + ', Rating: ' + player.rating + ')';
                    select.appendChild(option);
                }
            });
        }

        // H√†m ki·ªÉm tra gi·ªõi t√≠nh c·ªßa ƒë·ªôi
        function validateTeamGender(members, matchType) {
            if (members.length !== 2) return false;
            const genders = members.map(m => m.gender);
            if (matchType === 'mm') {
                return genders.every(g => g === 'Nam');
            } else if (matchType === 'mf') {
                return genders.includes('Nam') && genders.includes('N·ªØ');
            } else if (matchType === 'ff') {
                return genders.every(g => g === 'N·ªØ');
            } else if (matchType === 'mixed_mm_mf') {
                return true;
            }
            return false;
        }

        // H√†m ki·ªÉm tra ng∆∞·ªùi ch∆°i ƒë√£ thu·ªôc ƒë·ªôi n√†o ch∆∞a
        function isPlayerInTeam(playerName) {
            const teams = JSON.parse(localStorage.getItem('teams') || '[]');
            return teams.some(team => team.members.some(member => member.name === playerName));
        }

        // H√†m th√™m ƒë·ªôi v·ªõi validation
        function addTeam() {
            const name = document.getElementById('teamName').value.trim();
            const matchType = document.getElementById('teamMatchType').value;
            if (!name) {
                alert('T√™n ƒë·ªôi l√† b·∫Øt bu·ªôc!');
                return;
            }
            const selectedPlayers = Array.from(document.getElementById('teamPlayers').selectedOptions).map(opt => parseInt(opt.value));
            if (selectedPlayers.length !== 2) {
                alert('Ph·∫£i ch·ªçn ƒë√∫ng 2 ng∆∞·ªùi ch∆°i cho m·ªói ƒë·ªôi!');
                return;
            }
            const players = JSON.parse(localStorage.getItem('players') || '[]');
            const teamMembers = selectedPlayers.map(idx => players[idx]);
            if (!validateTeamGender(teamMembers, matchType)) {
                alert('Th√†nh vi√™n ƒë·ªôi kh√¥ng ph√π h·ª£p v·ªõi n·ªôi dung thi ƒë·∫•u!');
                return;
            }
            const avgRating = teamMembers.reduce((sum, p) => sum + parseFloat(p.rating), 0) / teamMembers.length || 0;
            const teams = JSON.parse(localStorage.getItem('teams') || '[]');
            teams.push({
                name: name,
                matchType: matchType,
                members: teamMembers,
                avgRating: avgRating.toFixed(2)
            });
            localStorage.setItem('teams', JSON.stringify(teams));
            loadTeamsTable();
            loadPlayerSelect();
            document.getElementById('teamForm').reset();
        }

        // H√†m t·∫°o ƒë·ªôi ng·∫´u nhi√™n
        function generateRandomTeam(type) {
            const players = JSON.parse(localStorage.getItem('players') || '[]');
            const teams = JSON.parse(localStorage.getItem('teams') || '[]');
            const usedPlayerNames = new Set(teams.flatMap(team => team.members.map(member => member.name)));
            const availableMales = players.filter(p => p.gender === 'Nam' && !usedPlayerNames.has(p.name)).slice();
            const availableFemales = players.filter(p => p.gender === 'N·ªØ' && !usedPlayerNames.has(p.name)).slice();
            let selected = [];

            if (type === 'mm') {
                if (availableMales.length < 2) return alert('Kh√¥ng ƒë·ªß ng∆∞·ªùi ch∆°i nam ch∆∞a ƒë∆∞·ª£c g√°n!');
                selected.push(availableMales.splice(Math.floor(Math.random() * availableMales.length), 1)[0]);
                selected.push(availableMales.splice(Math.floor(Math.random() * availableMales.length), 1)[0]);
            } else if (type === 'mf') {
                if (availableMales.length < 1 || availableFemales.length < 1) return alert('Kh√¥ng ƒë·ªß ng∆∞·ªùi ch∆°i nam ho·∫∑c n·ªØ ch∆∞a ƒë∆∞·ª£c g√°n!');
                selected.push(availableMales.splice(Math.floor(Math.random() * availableMales.length), 1)[0]);
                selected.push(availableFemales.splice(Math.floor(Math.random() * availableFemales.length), 1)[0]);
            } else if (type === 'ff') {
                if (availableFemales.length < 2) return alert('Kh√¥ng ƒë·ªß ng∆∞·ªùi ch∆°i n·ªØ ch∆∞a ƒë∆∞·ª£c g√°n!');
                selected.push(availableFemales.splice(Math.floor(Math.random() * availableFemales.length), 1)[0]);
                selected.push(availableFemales.splice(Math.floor(Math.random() * availableFemales.length), 1)[0]);
            } else if (type === 'mixed_mm_mf') {
                const subType = Math.random() > 0.5 ? 'mm' : 'mf';
                generateRandomTeam(subType);
                return;
            }

            const avgRating = selected.reduce((sum, p) => sum + parseFloat(p.rating), 0) / selected.length || 0;
            teams.push({
                name: 'ƒê·ªôi Ng·∫´u nhi√™n ' + (teams.length + 1),
                matchType: type,
                members: selected,
                avgRating: avgRating.toFixed(2)
            });
            localStorage.setItem('teams', JSON.stringify(teams));
            loadTeamsTable();
            loadPlayerSelect();
            alert('ƒê√£ t·∫°o ƒë·ªôi ng·∫´u nhi√™n!');
        }

        // H√†m t·∫£i b·∫£ng ƒë·ªôi
        function loadTeamsTable() {
            const table = document.getElementById('teamsTable');
            table.innerHTML = '<tr><th>STT</th><th>T√™n ƒê·ªôi</th><th>Th√†nh vi√™n</th><th>N·ªôi dung</th><th>Rating TB</th><th>H√†nh ƒë·ªông</th></tr>';
            const teams = JSON.parse(localStorage.getItem('teams') || '[]');
            document.getElementById('totalTeams').innerText = 'T·ªïng s·ªë ƒë·ªôi: ' + teams.length;
            teams.forEach((team, index) => {
                const row = table.insertRow();
                const membersNames = team.members.map(m => m.name).join(', ');
                const matchTypeText = team.matchType === 'mm' ? 'Nam - Nam' : 
                                      team.matchType === 'mf' ? 'Nam - N·ªØ' : 
                                      team.matchType === 'ff' ? 'N·ªØ - N·ªØ' : 'H·ªón h·ª£p Nam - Nam + Nam - N·ªØ';
                row.innerHTML = `<td>${index + 1}</td><td>${team.name}</td><td>${membersNames}</td><td>${matchTypeText}</td><td>${team.avgRating}</td><td><button onclick="editTeam(${index})">S·ª≠a</button> <button onclick="deleteTeam(${index})">X√≥a</button></td>`;
            });
        }

        // H√†m s·ª≠a ƒë·ªôi
        function editTeam(index) {
            const teams = JSON.parse(localStorage.getItem('teams') || '[]');
            const team = teams[index];
            document.getElementById('editTeamIndex').value = index;
            document.getElementById('editTeamName').value = team.name;
            document.getElementById('editTeamMatchType').value = team.matchType;
            loadPlayerSelect('editTeamPlayers');
            const select = document.getElementById('editTeamPlayers');
            Array.from(select.options).forEach(opt => {
                opt.selected = team.members.some(m => m.name === opt.text.split(' (')[0]);
            });
            team.members.forEach(member => {
                const option = document.createElement('option');
                option.value = -1;
                option.text = member.name + ' (' + member.gender + ', Rating: ' + member.rating + ')';
                option.selected = true;
                select.appendChild(option);
            });
            document.getElementById('editTeamModal').style.display = 'block';
        }

        // H√†m l∆∞u s·ª≠a ƒë·ªôi v·ªõi validation
        function saveEditTeam() {
            const index = parseInt(document.getElementById('editTeamIndex').value);
            const name = document.getElementById('editTeamName').value.trim();
            const matchType = document.getElementById('editTeamMatchType').value;
            if (!name) {
                alert('T√™n ƒë·ªôi l√† b·∫Øt bu·ªôc!');
                return;
            }
            const selectedPlayers = Array.from(document.getElementById('editTeamPlayers').selectedOptions).map(opt => {
                const name = opt.text.split(' (')[0];
                const players = JSON.parse(localStorage.getItem('players') || '[]');
                return players.find(p => p.name === name) || { name, gender: opt.text.includes('Nam') ? 'Nam' : 'N·ªØ', rating: parseFloat(opt.text.match(/Rating: (\d+\.\d)/)[1]) };
            });
            if (selectedPlayers.length !== 2) {
                alert('Ph·∫£i ch·ªçn ƒë√∫ng 2 ng∆∞·ªùi ch∆°i cho m·ªói ƒë·ªôi!');
                return;
            }
            if (!validateTeamGender(selectedPlayers, matchType)) {
                alert('Th√†nh vi√™n ƒë·ªôi kh√¥ng ph√π h·ª£p v·ªõi n·ªôi dung thi ƒë·∫•u!');
                return;
            }
            const avgRating = selectedPlayers.reduce((sum, p) => sum + parseFloat(p.rating), 0) / selectedPlayers.length || 0;
            const teams = JSON.parse(localStorage.getItem('teams') || '[]');
            teams[index] = {
                name: name,
                matchType: matchType,
                members: selectedPlayers,
                avgRating: avgRating.toFixed(2)
            };
            localStorage.setItem('teams', JSON.stringify(teams));
            document.getElementById('editTeamModal').style.display = 'none';
            loadTeamsTable();
            loadPlayerSelect();
        }

        // H√†m x√≥a ƒë·ªôi
        function deleteTeam(index) {
            const teams = JSON.parse(localStorage.getItem('teams') || '[]');
            teams.splice(index, 1);
            localStorage.setItem('teams', JSON.stringify(teams));
            loadTeamsTable();
            loadPlayerSelect();
        }

        // H√†m t·∫°o ƒë·ªôi ng·∫´u nhi√™n (nhi·ªÅu ƒë·ªôi)
        function generateRandomTeams(num) {
            const types = ['mm', 'mf', 'ff', 'mixed_mm_mf'];
            for (let i = 0; i < num; i++) {
                const type = types[Math.floor(Math.random() * types.length)];
                generateRandomTeam(type);
            }
        }

        // H√†m t·∫°o k·∫øt qu·∫£ v√≤ng b·∫£ng ng·∫´u nhi√™n (gi·∫£ ƒë·ªãnh)
        function generateRandomGroupResults() {
            alert('T·∫°o k·∫øt qu·∫£ v√≤ng b·∫£ng ng·∫´u nhi√™n...');
        }

        // H√†m t·∫°o k·∫øt qu·∫£ KO ng·∫´u nhi√™n (gi·∫£ ƒë·ªãnh)
        function generateRandomKOResults() {
            alert('T·∫°o k·∫øt qu·∫£ KO ng·∫´u nhi√™n...');
        }

        // H√†m xu·∫•t to√†n b·ªô gi·∫£i JSON
        function exportFullTournamentJSON() {
            const allData = {};
            ['tournamentConfig', 'btc', 'players', 'teams', 'sponsors', 'finance', 'schedule', 'groups', 'matches'].forEach(key => {
                allData[key] = localStorage.getItem(key) || null;
            });
            const blob = new Blob([JSON.stringify(allData)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'tournament.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        // H√†m import to√†n b·ªô gi·∫£i JSON
        function importFullTournamentJSON() {
            const fileInput = document.getElementById('import_full');
            const file = fileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const data = JSON.parse(e.target.result);
                    Object.keys(data).forEach(key => {
                        localStorage.setItem(key, data[key]);
                    });
                    loadTournamentConfig();
                    alert('ƒê√£ import to√†n b·ªô d·ªØ li·ªáu gi·∫£i ƒë·∫•u th√†nh c√¥ng!');
                    location.reload();
                };
                reader.readAsText(file);
            } else {
                alert('Vui l√≤ng ch·ªçn file JSON!');
            }
        }

        // H√†m xu·∫•t CSV
        function exportCSV(type) {
            const data = localStorage.getItem(type);
            if (data) {
                let csvContent = "data:text/csv;charset=utf-8,";
                if (type === 'teams') {
                    const teams = JSON.parse(data);
                    csvContent += "Name,MatchType,Members,AvgRating\n";
                    teams.forEach(team => {
                        const members = team.members.map(m => m.name).join(';');
                        csvContent += `${team.name},${team.matchType},${members},${team.avgRating}\n`;
                    });
                } else {
                    csvContent += convertToCSV(JSON.parse(data));
                }
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `${type}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert(`Kh√¥ng c√≥ d·ªØ li·ªáu cho ${type}!`);
            }
        }

        // H√†m h·ªó tr·ª£ chuy·ªÉn JSON sang CSV
        function convertToCSV(objArray) {
            if (!Array.isArray(objArray)) return '';
            const array = [Object.keys(objArray[0])].concat(objArray);
            return array.map(it => Object.values(it).toString()).join('\n');
        }

        // H√†m import CSV
        function importCSV(type) {
            const fileInput = document.getElementById(`import_${type}`);
            const file = fileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const csvData = e.target.result;
                    let jsonData;
                    if (type === 'teams') {
                        jsonData = convertTeamCSVToJSON(csvData);
                    } else {
                        jsonData = convertCSVToJSON(csvData);
                    }
                    localStorage.setItem(type, JSON.stringify(jsonData));
                    alert(`ƒê√£ import ${type} t·ª´ CSV th√†nh c√¥ng!`);
                    location.reload();
                };
                reader.readAsText(file);
            } else {
                alert('Vui l√≤ng ch·ªçn file CSV!');
            }
        }

        // H√†m chuy·ªÉn CSV sang JSON cho ƒë·ªôi
        function convertTeamCSVToJSON(csv) {
            const lines = csv.split('\n');
            const result = [];
            const headers = lines[0].split(',');
            for (let i = 1; i < lines.length; i++) {
                if (!lines[i]) continue;
                const obj = {};
                const currentline = lines[i].split(',');
                obj[headers[0]] = currentline[0];
                obj[headers[1]] = currentline[1];
                const memberNames = currentline[2].split(';');
                const players = JSON.parse(localStorage.getItem('players') || '[]');
                obj.members = memberNames.map(name => players.find(p => p.name === name)).filter(m => m);
                obj.avgRating = currentline[3];
                result.push(obj);
            }
            return result;
        }

        // H√†m chuy·ªÉn CSV sang JSON
        function convertCSVToJSON(csv) {
            const lines = csv.split('\n');
            const result = [];
            const headers = lines[0].split(',');
            for (let i = 1; i < lines.length; i++) {
                if (!lines[i]) continue;
                const obj = {};
                const currentline = lines[i].split(',');
                for (let j = 0; j < headers.length; j++) {
                    obj[headers[j]] = currentline[j];
                }
                result.push(obj);
            }
            return result;
        }

        // H√†m x√≥a t·ª´ng ph·∫ßn v·ªõi th√¥ng b√°o chi ti·∫øt
        function deleteSection(section) {
            const sectionNames = {
                tournamentConfig: 'C·∫•u h√¨nh Gi·∫£i ƒë·∫•u & S√¢n',
                btc: 'Ban T·ªï Ch·ª©c',
                players: 'Ng∆∞·ªùi ch∆°i',
                teams: 'ƒê·ªôi',
                sponsors: 'T√†i tr·ª£',
                finance: 'Thu chi',
                schedule: 'L·ªãch thi ƒë·∫•u',
                groups: 'B·∫£ng ƒë·∫•u',
                matches: 'Tr·∫≠n ƒë·∫•u'
            };
            if (confirm(`B·∫°n ch·∫Øc ch·∫Øn mu·ªën x√≥a d·ªØ li·ªáu ${sectionNames[section] || section}? ƒêi·ªÅu n√†y c√≥ th·ªÉ ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c ph·∫ßn ph·ª• thu·ªôc v√† kh√¥ng th·ªÉ ho√†n t√°c.`)) {
                localStorage.removeItem(section);
                if (section === 'tournamentConfig') {
                    document.getElementById('tournamentLogoPreview').style.display = 'none';
                    document.getElementById('paymentQRPreview').style.display = 'none';
                    updateFavicon(null);
                    loadVenueTable();
                }
                alert(`ƒê√£ x√≥a d·ªØ li·ªáu ${sectionNames[section] || section}!`);
                location.reload();
            }
        }

        // H√†m x√≥a to√†n b·ªô v·ªõi th√¥ng b√°o chi ti·∫øt
        function clearAllData() {
            const sections = ['tournamentConfig', 'btc', 'players', 'teams', 'sponsors', 'finance', 'schedule', 'groups', 'matches'];
            const sectionNames = {
                tournamentConfig: 'C·∫•u h√¨nh Gi·∫£i ƒë·∫•u & S√¢n',
                btc: 'Ban T·ªï Ch·ª©c',
                players: 'Ng∆∞·ªùi ch∆°i',
                teams: 'ƒê·ªôi',
                sponsors: 'T√†i tr·ª£',
                finance: 'Thu chi',
                schedule: 'L·ªãch thi ƒë·∫•u',
                groups: 'B·∫£ng ƒë·∫•u',
                matches: 'Tr·∫≠n ƒë·∫•u'
            };
            const existingSections = sections.filter(section => localStorage.getItem(section));
            const sectionDisplayNames = existingSections.map(section => sectionNames[section] || section);
            if (existingSections.length === 0) {
                alert('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ x√≥a!');
                return;
            }
            if (confirm(`B·∫°n ch·∫Øc ch·∫Øn mu·ªën x√≥a to√†n b·ªô d·ªØ li·ªáu, bao g·ªìm c√°c ph·∫ßn: ${sectionDisplayNames.join(', ')}? ƒêi·ªÅu n√†y kh√¥ng th·ªÉ ho√†n t√°c.`)) {
                existingSections.forEach(section => localStorage.removeItem(section));
                document.getElementById('tournamentLogoPreview').style.display = 'none';
                document.getElementById('paymentQRPreview').style.display = 'none';
                updateFavicon(null);
                loadVenueTable();
                alert(`ƒê√£ x√≥a c√°c ph·∫ßn d·ªØ li·ªáu: ${sectionDisplayNames.join(', ')}`);
                location.reload();
            }
        }

        // H√†m xu·∫•t v√† t·∫£i gi·∫£i ƒë·∫•u
        function exportTournament() {
            exportFullTournamentJSON();
        }
        function loadTournament() {
            importFullTournamentJSON();
        }

        // T·∫£i d·ªØ li·ªáu khi load trang
        window.onload = function() {
            loadBtcTable();
            loadPlayersTable();
            loadPlayerSelect('teamPlayers');
            loadPlayerSelect('editTeamPlayers');
            loadTeamsTable();
            loadTournamentConfig();
            loadVenueTable();
            loadGroupTable();
            loadMatchTable();
            document.getElementById('tournamentLogo').addEventListener('change', handleLogoUpload);
            document.getElementById('paymentQR').addEventListener('change', handleQRUpload);
        }
    </script>
</body>
</html>
